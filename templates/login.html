<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Login - MindNest</title>
  <link rel="stylesheet" href="/static/login.css" />
  <link rel="stylesheet" href="/static/theme.css" />
</head>
<body>
  <div class="login-card">
    <div class="login-header">

      <h1>ðŸ§  MindNest</h1>
    </div>
    <h2>Login</h2>

    <form method="POST" class="login-form">
     <h3>Sign in with Google</h3>

<script src="https://accounts.google.com/gsi/client" async defer></script>

<div id="g_id_onload"
     data-client_id="164236319937-il3g20o3jr5bkekvduum1lulfvm81384.apps.googleusercontent.com"
     data-callback="handleCredentialResponse"
     data-context="signin">
</div>

<div class="g_id_signin"
     data-type="standard"
     data-theme="outline"
     data-size="large">
</div>


      <div class="divider">
        <hr /><span class="divider-text">or</span><hr />
      </div>

      <input type="text" name="username" placeholder="User Id" required />
      <input type="password" name="password" placeholder="Password" required />

      <label class="remember-me">
        <input type="checkbox" /> Remember me
      </label>

      <button type="submit" class="login-btn">Log In</button>
      {% if error %}<div class="error">{{ error }}</div>{% endif %}
    </form>

    <p class="signup-text">
      Don't have an account?
      <a href="/signup">Sign up</a>
    </p>
  </div>

  <script>
    function handleCredentialResponse(response) {
      // 'response.credential' is the user's ID token (a JWT)
      console.log("ID Token received from Google: " + response.credential);

      // Send this token to your Flask backend for verification
      fetch('/verify-google-token', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ token: response.credential }),
      })
      .then(res => res.json())
      .then(data => {
        if (data.success) {
          // Redirect to the home page on successful login
          window.location.href = '/';
        } else {
          alert('Login Failed: ' + data.message);
        }
      });
    }
</script>
</body>
</html>