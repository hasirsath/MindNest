<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Analysis Result</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='result.css') }}">

  <style>
    .recommendations-container {
        margin-top: 2rem;
        padding-top: 1.5rem;
        border-top: 1px solid #e0e0e0;
    }
    .media-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1.5rem;
        margin-top: 1rem;
    }
    .media-card {
        background: #fff;
        border-radius: 12px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.08);
        padding: 1rem;
        text-align: center;
        transition: transform 0.2s ease;
    }
    .media-card:hover {
        transform: translateY(-4px);
    }
    .media-card p {
        margin-top: 0.8rem;
        font-weight: 500;
        font-size: 0.95rem;
        color: #333;
    }
    iframe {
        width: 100%;
        border-radius: 12px;
    }
  </style>
</head>
<body>

<nav>
  <div class="nav-container">
    <span class="logo">ğŸ§  MindNest</span>
    <div class="nav-links">
      <a href="{{ url_for('home') }}">Home</a>
      <a href="{{ url_for('dashboard') }}">Dashboard</a>
      <a href="{{ url_for('history') }}">History</a>
      
      {% if session.get('logged_in') %}
        <a href="{{ url_for('logout') }}" class="nav-auth">Logout</a>
        {% if session.get('user_picture') %}
            <img src="{{ session.get('user_picture') }}" alt="{{ session.get('user_name') }}" class="nav-avatar" style="width:32px;height:32px;border-radius:50%;object-fit:cover;margin-left:12px;border:2px solid rgba(255,255,255,0.6);" />
        {% endif %}
      {% else %}
        <a href="{{ url_for('login') }}" class="nav-auth">Login</a>
      {% endif %}
    </div>
  </div>
</nav>

<div class="container">
  <h2>Analysis Result</h2>

  <div class="entry">{{ text }}</div>

  <div class="badges">
    <span class="badge mood-{{ result.mood|lower }}">ğŸ˜Š Mood: {{ result.mood|capitalize }}</span>
    <span class="badge emotion-{{ result.emotion|lower }}">ğŸŒˆ Emotion: {{ result.sentiment|capitalize }}</span>
  </div>

  <div class="suggestion"><strong>Suggestion:</strong> {{ result.suggestion }}</div>

  {% if music_recs %}
  <div class="recommendations-container">
      <h3>Music to Match Your Mood ğŸµ</h3>
      <div class="media-grid">
          {% for playlist in music_recs %}
          <div class="media-card">
              <iframe style="border-radius:12px"
                      src="https://open.spotify.com/embed/playlist/{{ playlist.id }}?utm_source=generator"
                      height="380" frameborder="0" 
                      allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
                      loading="lazy"></iframe>
              <p>{{ playlist.title }}</p>
          </div>
          {% endfor %}
      </div>
  </div>
  {% endif %}


{% if video_recs %}
  <div class="recommendations-container">
      <h3>Video Recommendations ğŸ¥</h3>
      <div class="media-grid">
          {% for video in video_recs %}
          <div class="media-card">
              <iframe width="300" height="180"
                      src="https://www.youtube.com/embed/{{ video.id }}?rel=0&autoplay=0"
                      frameborder="0"
                      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                      allowfullscreen>
              </iframe>
              <p>{{ video.title }}</p>
          </div>
          {% endfor %}
      </div>
  </div>
{% endif %}





  <div class="actions">
    <a href="{{ url_for('home') }}" class="btn edit">â† Back to Journal</a>
    <a href="{{ url_for('dashboard') }}" class="btn edit">ğŸ“Š View Dashboard</a>
    <button onclick="window.print()" class="btn delete">ğŸ“„ Save as PDF</button>
  </div>
</div>

<script>
  const mood = "{{ result.mood|lower }}";
  const emotion = "{{ result.sentiment|lower }}";
</script>

</body>
</html>
